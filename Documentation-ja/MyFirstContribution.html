<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 9.1.1" />
<title>My First Contribution to the Git Project</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overridden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>My First Contribution to the Git Project</h1>
<span id="revdate">2023-07-22</span>
</div>
<div id="content">
<div class="sect1">
<h2 id="summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph"><p>これは、Gitツリーに変更を加え、レビューのために送信し、コメントに基づいて変更を加えるエンドツーエンドのワークフローを説明するチュートリアルです。</p></div>
<div class="sect2">
<h3 id="prerequisites">前提条件</h3>
<div class="paragraph"><p>このチュートリアルは、あなたがGitを使用してソースコードを管理することにすでにかなり精通していることを前提としています。 Gitワークフローの手順はほとんど説明していません。</p></div>
</div>
<div class="sect2">
<h3 id="related-reading">Related Reading</h3>
<div class="paragraph"><p>このチュートリアルは、以下のドキュメントを要約することを目的としていますが、読めば有用な追加事項を見つけることができるでしょう:</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>Documentation/SubmittingPatches</code>
</p>
</li>
<li>
<p>
<code>Documentation/howto/new-command.txt</code>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="getting-help">Getting Help</h3>
<div class="paragraph"><p>あなたが行き詰まった場合は、以下の場所で助けを求めることができます。</p></div>
<div class="sect3">
<h4 id="_a_href_mailto_git_vger_kernel_org_git_vger_kernel_org_a"><a href="mailto:git@vger.kernel.org">git@vger.kernel.org</a></h4>
<div class="paragraph"><p>これは、コードレビュー、バージョンアナウンス、デザインディスカッションなどが行われるメインのGitプロジェクトメーリングリストです。 貢献に興味のある方は、ここに質問を投稿してください。 Gitメーリングリストにはプレーンテキストのみの電子メールが必要であり、メールに返信するときはインライン投稿とボトム投稿を優先します。 あなたはあなたへのすべての返信でCCされます。 オプションで、本文に「subscribe git」<a href="mailto:を付けてmajordomo@vger.kernel.orgに電子メールを送信することにより">を付けてmajordomo@vger.kernel.orgに電子メールを送信することにより</a>、リストをサブスクライブできます。 このメーリングリストの <a href="https://lore.kernel.org/git">archive</a> はブラウザで表示できます。</p></div>
</div>
<div class="sect3">
<h4 id="_a_href_https_groups_google_com_forum_forum_git_mentoring_git_mentoring_googlegroups_com_a"><a href="https://groups.google.com/forum/#!forum/git-mentoring">git-mentoring@googlegroups.com</a></h4>
<div class="paragraph"><p>このメーリングリストは、新しい寄稿者を対象としており、メインリストの一般の人の目に触れないように質問を投稿したり回答を受け取ったりする場所として作成されました。 メンターの新参者を支援することに特に関心のあるベテランの貢献者がリストに含まれています。 検索インデクサーを回避するには、メッセージを表示するためにグループメンバーシップが必要です。 誰でも参加でき、承認は必要ありません。</p></div>
</div>
<div class="sect3">
<h4 id="_a_href_https_web_libera_chat_git_devel_git_devel_a_on_libera_chat"><a href="https://web.libera.chat/#git-devel">#git-devel</a> on Libera Chat</h4>
<div class="paragraph"><p>このIRCチャネルは、Gitコントリビューター間の会話用です。 誰かが現在オンラインで、あなたの質問に対する答えを知っている場合、あなたはリアルタイムで助けを受け取ることができます。 それ以外の場合は、 <a href="https://colabti.org/irclogger/irclogger_logs/git-devel">scrollback</a> を読んで、誰かがあなたに回答したかどうかを確認できます。 IRCはオフラインのプライベートメッセージを許可していません。そのため、誰かにプライベートメッセージを送信してから、IRCからログアウトしようとすると、その人はあなたに応答できません。 切断した場合に回答できるように、また他の人が会話から学ぶことができるように、チャネルで質問することをお勧めします。</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started">Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cloning">Clone the Git Repository</h3>
<div class="paragraph"><p>Gitは多くの場所でミラーリングされています。 それらの1つからリポジトリのクローンを作成します。 <a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a> は、クローンを作成するのに最適な場所の1つがGitHubのミラーであることを示しています。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git clone https://github.com/git/git git
$ cd git</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="dependencies">依存関係のインストール</h3>
<div class="paragraph"><p>ソースからGitをビルドするには、あなたはシステムにいくつかの依存関係をインストールする必要があります。 必要なもののヒントについては、外部プログラムとライブラリへのGitの依存関係に関するセクションに細心の注意を払って、 <code>INSTALL</code> を見ることで分かります。 そのドキュメントには、インストールせずに新しく構築したGitを「テスト運転」(test-drive)する方法が記載されています。 これが、このチュートリアルで使用する方法です。</p></div>
<div class="paragraph"><p>上記手順でGitの新しいクローンを作成して、環境に必要なものがすべて揃っていることを確認してください:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ make</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">Gitのビルドは並列化可能です。 <code>-j#</code> は上記に含まれていませんが、ここや他の場所で好きなように使用できます。</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="identify-problem">Identify Problem to Solve</h3>
<div class="paragraph"><p>このチュートリアルでは、「Pony Saying &#8216;Um, Hello&#8217;」の略である新しいコマンド <code>git psuh</code> (訳注:pushでは無くてpsuh)を追加します。これは、ユーザーの通常の日常のワークフローで頻繁に呼び出されるにもかかわらず、実装されていない機能です。</p></div>
<div class="paragraph"><p>(この分野では <code>sl</code> のような人気コマンドの実装の他にも、いくつかの取り組みが見られます。)</p></div>
</div>
<div class="sect2">
<h3 id="setup-workspace">Set Up Your Workspace</h3>
<div class="paragraph"><p>まず、変更に取り組むための開発ブランチを作成することから始めましょう。 <code>Documentation/SubmittingPatches</code> によると、まったく新しいコマンドは新機能であるため、<code>master</code> に基づいて作業するのは問題ありません。 ただし、将来のバグ修正などについては、そのドキュメントを確認し、適切なブランチに基づいて作成する必要があります。</p></div>
<div class="paragraph"><p>このドキュメントでは、すべての作業を、アップストリームプロジェクトの <code>master</code> ブランチを基にして行います。 以下のように、開発に使用する <code>psuh</code> ブランチを作成します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git checkout -b psuh origin/master</code></pre>
</div></div>
<div class="paragraph"><p>私達は複数のパッチを含むトピックを同時に、レビューのために送信する方法を示すために、ここでいくつかのコミットを行います。</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="code-it-up">Code It Up!</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">リファレンス実装は <a href="https://github.com/nasamuffin/git/tree/psuh">https://github.com/nasamuffin/git/tree/psuh</a> にあります。</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="add-new-command">Adding a New Command</h3>
<div class="paragraph"><p>沢山のサブコマンドが組み込みとして書かれています。つまり、C言語で実装され、メインの <code>git</code> 実行ファイルにコンパイルされているということです。非常にシンプルな <code>psuh</code> コマンドを組み込みで実装することで、コードベースの構造や、内部 APIや、貢献者としてレビュー担当者やメンテナと共にこの変更をシステムに統合するプロセス、を見せることができます。</p></div>
<div class="paragraph"><p>組み込みサブコマンドは通常、 サブコマンドにちなんで名付けられ、 <code>cmd_</code> という名前の関数の後にサブコマンドの名前が続く、 <code>builtin/</code> 内に含まれるソースファイルに実装されます。 したがって、コマンドを <code>builtin/psuh.c</code> に実装するのは理にかなっています。 そのファイルを作成し、その中に、スタイルとシグネチャに一致する関数であなたのコマンドのエントリポイントを記述します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>int cmd_psuh(int argc, const char **argv, const char *prefix)</code></pre>
</div></div>
<div class="paragraph"><p>また、私達は psuhの宣言を追加する必要があります。 <code>builtin.h</code> を開き、宣言をアルファベット順に保つために、 <code>cmd_pull</code> の宣言を見つけ、その直前に <code>psuh</code> の行を追加します。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>int cmd_psuh(int argc, const char **argv, const char *prefix);</code></pre>
</div></div>
<div class="paragraph"><p>そして、あなたの <code>push.c</code> に必ず <code>#include "builtin.h"</code> を書き込んでください。</p></div>
<div class="paragraph"><p>早速、その関数に使い捨てのprintfを追加します。 ビルドルールを追加してコマンドを登録できるようになったので、これは適切な開始点です。</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">あなたの使い捨てのテキスト、およびこのチュートリアルの過程で追加するテキストの多くは、ユーザー向けです。 つまり、ローカライズ可能である必要があります。 <code>po/README.md</code> の 「Marking strings for translation」をご覧ください。 チュートリアル全体を通して、必要に応じて翻訳用の文字列にマークを付けます。 将来、ユーザー向けのコマンドを作成するときにもそうする必要があります。</td>
</tr></table>
</div>
<div class="listingblock">
<div class="content">
<pre><code>int cmd_psuh(int argc, const char **argv, const char *prefix)
{
        printf(_("Pony saying hello goes here.\n"));
        return 0;
}</code></pre>
</div></div>
<div class="paragraph"><p>ではビルドしてみましょう。 <code>Makefile</code> を開き、 <code>builtin /pull.o</code> が <code>BUILTIN_OBJS</code> に追加されている場所を見つけ、次に、それと同一の方法でアルファベット順になるように <code>builtin/psuh.o</code> を追加します。それができたら、最上位ディレクトリに移動し、 <code>make</code> を使用してビルドします。 また、 <code>DEVELOPER = 1</code> 変数を追加して、いくつかの追加の警告をオンにします:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ echo DEVELOPER=1 &gt;config.mak
$ make</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">あなたがGitプロジェクトを開発するときは、 <code>DEVELOPER</code> フラグを使用することをお勧めします。 何らかの理由で機能しない場合は、オフにすることができますが、その問題をメーリングリストに記載することをお勧めします。</td>
</tr></table>
</div>
<div class="paragraph"><p>素晴らしい! これで、あなたの新しいコマンドそれ自体は問題なくビルドされます。 しかし、まだ誰もそれを呼び出しません。次はそこをいじりましょう。</p></div>
<div class="paragraph"><p>コマンドのリストは <code>git.c</code> にあります。 <code>commands[]</code> 配列に <code>cmd_struct</code> を追加することで、新しいコマンドを登録できます。 <code>struct cmd_struct</code> は、コマンド名、コマンドの実装への関数ポインタ、およびセットアップオプションフラグを含む文字列を受け取ります。 今のところは <code>push</code> を模倣し続けることしましょう。 <code>cmd_push</code> が登録されている行を見つけてコピーし、 <code>cmd_psuh</code> に変更して、新しい行をアルファベット順に(<code>cmd_pull</code> の直前に)配置します。</p></div>
<div class="paragraph"><p>オプションは、「Adding a new built-in. 」の「builtin.h」に記載されています。 後でユーザーの現在のワークスペースコンテキストに関するデータを出力したいので、Gitディレクトリが必要です。 そのため、あなたの唯一のオプションとして <code>RUN_SETUP</code> を選択します。</p></div>
<div class="paragraph"><p>早速、もう一度ビルドしてください。 きれいなビルドが表示されるはずなので、ざっと動かしてみて、それが機能するかどうかを確認しましょう。 <code>bin-wrappers</code> ディレクトリにあなたがテストに使用できるバイナリがあります。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ ./bin-wrappers/git psuh</code></pre>
</div></div>
<div class="paragraph"><p>見たまえ！あなたは今、コマンドをゲットしました！よくやった！ では、これをコミットするとしましょう。</p></div>
<div class="paragraph"><p><code>git status</code> は、変更された <code>Makefile</code> と <code>builtin.h</code> と` git.c` と 追跡されていない <code>builtin/psuh.c</code> と <code>git-psuh</code> を明らかにします。 まず、無視する必要のあるバイナリを処理しましょう。 エディターで <code>.gitignore`を開き、 `/git-pull</code> を見つけて、新しいコマンドのエントリをアルファベット順に追加します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>...
/git-prune-packed
/git-psuh
/git-pull
/git-push
/git-quiltimport
/git-range-diff
...</code></pre>
</div></div>
<div class="paragraph"><p><code>git status</code> をもう一度チェックすると、 <code>git-push</code> が追跡されていないリストから削除され、 <code>.gitignore</code> が変更されたリストに追加されていることがわかります。 これで、私達はステージングしてコミットできます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git add Makefile builtin.h builtin/psuh.c git.c .gitignore
$ git commit -s</code></pre>
</div></div>
<div class="paragraph"><p>あなたがコミットメッセージを書くためにエディターが表示されます。 作業中のコンポーネントの名前を含む50桁以下の件名でコミットを開始し、その後に空行1行(常に必須)、そして内容の大部分を提供するコミットメッセージの本文を続けます。 特に、diffから簡単に理解できない場合は、変更の「理由」を明示して提供することを忘れないでください。 コミットメッセージを編集する際に、上記 <code>-s</code> によって追加された <code>Signed-off-by</code> トレーラーを削除しないでください。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>psuh: add a built-in by popular demand

Internal metrics indicate this is a command many users expect to be
present. So here's an implementation to help drive customer
satisfaction and engagement: a pony which doubtfully greets the user,
or, a Pony Saying "Um, Hello" (PSUH).

This commit message is intentionally formatted to 72 columns per line,
starts with a single line as "commit message subject" that is written as
if to command the codebase to do something (add this, teach a command
that). The body of the message is designed to add information about the
commit that is not readily deduced from reading the associated diff,
such as answering the question "why?".
JP)このコミットメッセージは意図的に一行72桁のフォーマットになっており、
"commit message subject" という一行で始まり、コードベースに何かを命令
するように書かれています(これを追加しろ、そのコマンドを教える、等)。
メッセージの本文は、関連する diff を読んだだけではわからないコミットに
関する情報、たとえば "なぜ？" という質問に答えるような情報を追加するよ
うに意図されています。

Signed-off-by: A U Thor &lt;author@example.com&gt;</code></pre>
</div></div>
<div class="paragraph"><p>早速、 <code>git show</code> を使用して新しいコミットを調べます。 "psuh:" は、主に <code>psuh</code> コマンドを変更したことを示します。 件名は、読者にあなたが何を変更したかについての考えを与えます。 サインオフライン(<code>-s</code>)は、Developer&#8217;s Certificate of Origin 1.1(開発者の原産地証明書1.1)に同意することを示します(<code>Documentation/SubmittingPatches</code> [[dco]] ヘッダー参照)。</p></div>
<div class="paragraph"><p>チュートリアルの残りの部分では、簡潔にするために件名のみをリストします。 ただし、完全に肉付けされたコミットメッセージの例は、このドキュメントの上部にリンクされているリファレンス実装で入手できます。</p></div>
</div>
<div class="sect2">
<h3 id="implementation">Implementation</h3>
<div class="paragraph"><p>文字列を出力する以外に、少なくとも何かを行うと便利です。 まず、私たちが得たものすべてを見てみましょう。</p></div>
<div class="paragraph"><p>あなたの <code>cmd_psuh</code> 実装を変更して、渡された引数をダンプし、既存の <code>printf()</code> 呼び出しはそのままにします:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        int i;

        ...

        printf(Q_("Your args (there is %d):\n",
                  "Your args (there are %d):\n",
                  argc),
               argc);
        for (i = 0; i &lt; argc; i++)
                printf("%d: %s\n", i, argv[i]);

        printf(_("Your current working directory:\n&lt;top-level&gt;%s%s\n"),
               prefix ? "/" : "", prefix ? prefix : "");</code></pre>
</div></div>
<div class="paragraph"><p>ビルドして試してみてください。 ご想像のとおり、私達のコマンドの名前を含め、私達がコマンドラインで与えたものはほとんど何でもあります。 (<code>prefix</code> が空の場合は、 <code>cd Documentation/ &amp;&amp; ../bin-wrappers/git psuh</code> としてみてください)。 これあまり役に立ちません。 では、私達は他にどのようなコンテキストを取得できるでしょうか？</p></div>
<div class="paragraph"><p><code>#include "config.h"</code> 行を追加します。 そして関数本体にちょびっと追加します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        const char *cfg_name;

...

        git_config(git_default_config, NULL);
        if (git_config_get_string_tmp("user.name", &amp;cfg_name) &gt; 0)
                printf(_("No name is found in config\n"));
        else
                printf(_("Your name: %s\n"), cfg_name);</code></pre>
</div></div>
<div class="paragraph"><p><code>git_config()</code> は、Gitに認識されている構成ファイルから構成を把握し、標準の優先順位ルールを適用します。 <code>git_config_get_string_tmp()</code> は特定のキー("user.name")を検索し、値を提供します。 このような単一キー探索関数は多数あります。 それらすべて(および <code>git_config()</code> の使用方法に関する詳細情報)は、 <code>Documentation/technical/api-config.txt</code> で確認できます。</p></div>
<div class="paragraph"><p>出力された名前が、実行時に表示される名前と一致することがわかります:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git config --get user.name</code></pre>
</div></div>
<div class="paragraph"><p>すばらしい！ これで、Git構成の値を確認する方法がわかりました。 これもコミットしましょう。そうすれば、自身の成果を失うことはありません。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git add builtin/psuh.c
$ git commit -sm "psuh: show parameters &amp; config opts"</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">繰り返しになりますが、上記のように <code>-m</code> で済ますのはチュートリアルを簡潔にするためです。 実際の変更では、 <code>-m</code> を使用するのではなく、エディターを使用して意味のあるメッセージを記述してください。</td>
</tr></table>
</div>
<div class="paragraph"><p>さらに、ユーザーの作業コンテキストがどのようなものかを知っておくと便利です。 ユーザーの現在のブランチの名前を出力できるかどうかを見てみましょう。 <code>git status</code> の実装を模倣できます。私達は、出力関数が <code>wt-status.c</code> にあり、ブランチが <code>struct wt_status</code> に保持されていることが分かりました。</p></div>
<div class="paragraph"><p><code>wt_status_print()</code> は、 <code>builtin/commit.c</code> の <code>cmd_status()</code> によって呼び出されます。 その実装を見ると、ステータス構成が以下のように入力されていることがわかります:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>status_init_config(&amp;s, git_status_config);</code></pre>
</div></div>
<div class="paragraph"><p>しかし、ドリルダウンすると、 <code>status_init_config()</code> が <code>git_config()</code> の呼び出しをラップしていることがわかります。 前のコミットで私達が書いたコードを変更してみましょう。</p></div>
<div class="paragraph"><p><code>struct wt_status</code> を使用できるように、必ず以下のヘッダーファイルを含めてください:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>#include "wt-status.h"</code></pre>
</div></div>
<div class="paragraph"><p>次に、 あなたの <code>cmd_psuh</code> 実装を変更して、 あなたの <code>struct wt_status</code> を宣言し、準備して、その内容を出力します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        struct wt_status status;

...

        wt_status_prepare(the_repository, &amp;status);
        git_config(git_default_config, &amp;status);

...

        printf(_("Your current branch: %s\n"), status.branch);</code></pre>
</div></div>
<div class="paragraph"><p>もう一度実行して、確認します。&#8201;&#8212;&#8201;これがあなたの現在のブランチの(冗長な)名前です！</p></div>
<div class="paragraph"><p>これもコミットしましょう。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git add builtin/psuh.c
$ git commit -sm "psuh: print the current branch"</code></pre>
</div></div>
<div class="paragraph"><p>(コミットしたので)今や、その特定のコミットに関する情報を私達が取得できるかどうかを見てみましょう。</p></div>
<div class="paragraph"><p>幸いなことに、ここでは、私達のためにいくつかのヘルパーがあります。 <code>commit.h</code> には <code>lookup_commit_reference_by_name</code> という関数があり、ハードコードされた文字列を簡単に設定できます。 <code>pretty.h</code> には、完全な形式のオブジェクトを渡す必要のない非常に便利な <code>pp_commit_easy()</code> 呼び出しがあります。</p></div>
<div class="paragraph"><p>以下のインクルードファイルを追加します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>#include "commit.h"
#include "pretty.h"</code></pre>
</div></div>
<div class="paragraph"><p>次に、 <code>cmd_psuh()</code> の実装内で、宣言とロジックの近くにそれぞれ以下の行を追加します。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        struct commit *c = NULL;
        struct strbuf commitline = STRBUF_INIT;

...

        c = lookup_commit_reference_by_name("origin/master");

        if (c != NULL) {
                pp_commit_easy(CMIT_FMT_ONELINE, c, &amp;commitline);
                printf(_("Current commit: %s\n"), commitline.buf);
        }</code></pre>
</div></div>
<div class="paragraph"><p><code>struct strbuf</code> は、基本的な <code>char *</code> にいくつかの安全機構(safety belts)を提供します。そのうちの1つは、バッファオーバーランを防ぐための長さのメンバーです。 これは <code>STRBUF_INIT</code> でうまく初期化する必要があります。 <code>char*</code> を渡す必要がある場合は、この点に注意してください。</p></div>
<div class="paragraph"><p><code>lookup_commit_reference_by_name</code> は渡された名前を解決するので、その値で遊んでみて、どんなことを思いつくか見てみましょう。</p></div>
<div class="paragraph"><p><code>pp_commit_easy</code> は、フォーマット構造体全体ではなく、単一のフォーマット列挙型の省略形をとる <code>pretty.h</code> の便利なラッパーです。 そしてそれから、その省略形に従ってコミットをきれいに印刷(pretty-prints)します。 これらは、多くのGitコマンドで <code>--pretty=FOO</code> で使用できる形式に似ています。</p></div>
<div class="paragraph"><p>ビルドして実行すると、あなたが例で同一の名前を使用している場合は、あなたが知っている <code>origin/master</code> に最新のコミットの件名が表示されます。ちゃんとできました！ これもコミットしましょう。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git add builtin/psuh.c
$ git commit -sm "psuh: display the top of origin/master"</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="add-documentation">Adding Documentation</h3>
<div class="paragraph"><p>素晴らしい！ あなたはコミュニティと共有する準備ができている素晴らしい新しいコマンドを持っています。 だがちょっと待って欲しい。&#8201;&#8212;&#8201;これはあまりユーザーフレンドリーではありません。 以下を実行してみます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ ./bin-wrappers/git help psuh</code></pre>
</div></div>
<div class="paragraph"><p>あなたの新しいコマンドは文書化されていません！ これを直しましょう。</p></div>
<div class="paragraph"><p><code>Documentation/git-*.txt</code> を見てください。 これらは、Gitが知っているサブコマンドのマニュアルページです。 これらを開いてフォーマットを理解するために確認することもできますが、まずは新しいファイル <code>Documentation/git-psuh.txt</code> を作成します。 Gitプロジェクトのほとんどのドキュメントと同様に、ヘルプページは AsciiDoc で作成されています(CodingGuidelinesの「Writing Documentation」セクションを参照)。 以下のテンプレートに従ってあなた独自のmanpageを作成します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>git-psuh(1)
===========

NAME
----
git-psuh - Delight users' typo with a shy horse


SYNOPSIS
--------
[verse]
'git-psuh [&lt;arg&gt;...]'

DESCRIPTION
-----------
...

OPTIONS[[OPTIONS]]
------------------
...

OUTPUT
------
...

GIT
---
Part of the linkgit:git[1] suite</code></pre>
</div></div>
<div class="paragraph"><p>注意すべき最も重要な部分は、 = で下線が引かれたファイルヘッダー、NAMEセクション、およびコマンドが引数を取る場合に通常は文法を含むSYNOPSISです。 ドキュメントが他のGitおよびUNIXのmanpageと一致するように、確立されたmanpageヘッダー(well-established manpage headers)を使用するようにしてください。 これにより、ユーザーは必要な情報が含まれていることがわかっているセクションにスキップできるため、ユーザーが楽をできます。</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">ドキュメントを作成する前に、パッケージ <code>asciidoc</code> がインストールされていることを確認してください。</td>
</tr></table>
</div>
<div class="paragraph"><p>今や、あなたのmanpageを記述したので、明示的にそれをビルドする必要があります。 以下のようにしてAsciiDocを人間が読めるtroffに変換します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ make all doc
$ man Documentation/git-psuh.1</code></pre>
</div></div>
<div class="paragraph"><p>または</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ make -C Documentation/ git-psuh.1
$ man Documentation/git-psuh.1</code></pre>
</div></div>
<div class="paragraph"><p>これは <code>git help</code> を実行するほど満足のいくものではありませんが、少なくともあなたのヘルプページが正しく表示されていることを確認できます。</p></div>
<div class="paragraph"><p>トップレベルから <code>make check-docs</code> を実行することで、ドキュメントの適用範囲が良好であることを確認することもできます(つまり、プロジェクトはあなたのコマンドが実装され、ドキュメント化されていることを確認します)。</p></div>
<div class="paragraph"><p>早速、あなたの新しいドキュメントの変更をコミットします。</p></div>
</div>
<div class="sect2">
<h3 id="add-usage">Adding Usage Text</h3>
<div class="paragraph"><p><code>./bin-wrappers/git psuh -h</code> を実行してみてください。 コマンドは最後にクラッシュするはずです。 なぜならこれは、 <code>-h</code> が、あなたのコマンドが使用法の出力を処理しなければならない特殊なケースであるためです。</p></div>
<div class="paragraph"><p><code>Documentation/technical/api-parse-options.txt</code> をご覧下さい。 これはあなたが扱えるようにする必要があるオプションを引っ張り出すめの便利なツールで、使用法の文字列を受け取ります。</p></div>
<div class="paragraph"><p>これを使用するには、使用文字列のNULLで終了する配列と <code>builtin_psuh_options</code> 配列を準備する必要があります。</p></div>
<div class="paragraph"><p><code>#include "parse-options.h"</code> 行を追加します。</p></div>
<div class="paragraph"><p>グローバルスコープで、あなたの使用法文字列の配列を追加します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>static const char * const psuh_usage[] = {
        N_("git psuh [&lt;arg&gt;...]"),
        NULL,
};</code></pre>
</div></div>
<div class="paragraph"><p>次に、あなたの <code>cmd_psuh()</code> 実装内で、 <code>option</code> 構造体を宣言して入力できます。 私たちのものはかなり退屈ですが、 <code>parse_options()</code> をより詳細に調べたい場合は、さらに追加することができます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        struct option options[] = {
                OPT_END()
        };</code></pre>
</div></div>
<div class="paragraph"><p>最後に、あなたの引数とプレフィックスを出力する前に、 <code>parse-options()</code> の呼び出しを追加します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        argc = parse_options(argc, argv, prefix, options, psuh_usage, 0);</code></pre>
</div></div>
<div class="paragraph"><p>この呼び出しにより、あなたの <code>argv</code> パラメーターが変更されます。 <code>argv</code> から <code>options</code> で指定したオプションが削除され、 <code>options</code> エントリからポイントされた場所が更新されます。 必ず あなたの <code>argc</code> を <code>parse_options()</code> の結果に置き換えてください。そうしないと、後で <code>argv</code> をパースしようとしたときに混乱します。</p></div>
<div class="paragraph"><p>特別な引数 <code>--</code> に注意する価値があります。 ご存知かもしれませんが、多くのUnixコマンドは「名前付きパラメータの終わり」を示すために <code>--</code> を使用します&#8201;&#8212;&#8201;<code>--</code> の後のすべてのパラメータは単に位置引数として解釈されます。 (これは、通常はフラグとして解釈されるものをパラメーターとして渡したい場合に便利です。) <code>parse_options()</code> は <code>--</code> に達するとパースを終了し、その後、残りのオプションをそのまま提供します。</p></div>
<div class="paragraph"><p>今や、あなたは使用上のヒントが得られたので、 <code>command-list.txt</code> から生成される <code>git help git</code> または <code>git help -a</code> で示される一般的なコマンドリストにそれを表示する方法をGitに教えることができます。 あなたは <code>git-pull</code> の行を見つけて、その上に あなたの <code>git-psuh</code> 行をアルファベット順に追加できるようにします。これで、前述のヘルプコマンドのどこに表示されるかに影響を与える、コマンドに関するいくつかの属性を追加できます。 <code>command-list.txt</code> の上部は、各属性の意味に関する情報を共有しています。これらのヘルプページでは、コマンドはこれらの属性に従ってソートされています。 <code>git psuh</code> はユーザー向け、つまり磁器コマンドです。そのため、「mainporcelain」としてマークします。 「mainporcelain」コマンドの場合、 <code>command-list.txt</code> の上部にあるコメントは、オプションで別のリストから属性を追加することもできることを示しています。 <code>git psuh</code> はユーザーのワークスペースに関する情報を表示しますが、何も変更しないので、「info」としてマークしましょう。属性を他の <code>command-list.txt</code> と同一のスタイルに保ち、適宜空白を使用してそれらを整列して記述します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>git-prune-packed                        plumbingmanipulators
git-psuh                                mainporcelain           info
git-pull                                mainporcelain           remote
git-push                                mainporcelain           remote</code></pre>
</div></div>
<div class="paragraph"><p>再びビルドします。 これで、 <code>-h</code> を指定して実行すると、他に何か面白いことが起こる前に、使用法が出力され、コマンドが終了するはずです。 すばらしい！</p></div>
<div class="paragraph"><p>それでは、これもコミットしておいてください。</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing">Testing</h2>
<div class="sectionbody">
<div class="paragraph"><p>あなたのコードをテストすることは重要です&#8201;&#8212;&#8201;このような小さなおもちゃのようなコマンドであっても。 さらに、あなたのパッチはテストなしではGitツリーに受け入れられません。 テストは以下のようにする必要があります:</p></div>
<div class="ulist"><ul>
<li>
<p>
機能の現在の振る舞いを説明する
</p>
</li>
<li>
<p>
現在の振る舞いが期待される振る舞いと一致することを証明する
</p>
</li>
<li>
<p>
変更後に外部から見える動作が壊れていないことを確認します
</p>
</li>
</ul></div>
<div class="paragraph"><p>それでは、いくつかのテストを書いてみましょう。</p></div>
<div class="paragraph"><p>関連資料: <code>t/README</code></p></div>
<div class="sect2">
<h3 id="overview-test-structure">Overview of Testing Structure</h3>
<div class="paragraph"><p>Gitのテストは <code>t/</code> にあり、 <code>t/README</code> の NamingTestsセクションに示されているスキーマを使用して4桁の10進数で名前が付けられます。</p></div>
</div>
<div class="sect2">
<h3 id="write-new-test">Writing Your Test</h3>
<div class="paragraph"><p>今回はおもちゃコマンドなので、思い切ってテストにt9999という名前を付けましょう。 ただし、ファミリとサブコマンドの組み合わせの多くはいっぱいいっぱいであるため、ベストプラクティスは、追加したコマンドに十分近いコマンドを見つけて、その名前付け空間を共有することです。</p></div>
<div class="paragraph"><p>新しいファイル <code>t/t9999-psuh-tutorial.sh</code> を作成します。 ヘッダーは以下のように始めます(<code>t/README</code> の「WritingTests」および「Source <em>test-lib.sh</em>」参照):</p></div>
<div class="listingblock">
<div class="content">
<pre><code>#!/bin/sh

test_description='git-psuh test

This test runs git-psuh and makes sure it does not crash.'

. ./test-lib.sh</code></pre>
</div></div>
<div class="paragraph"><p>TAP形式の結果を出力するために、テストは <code>test_expect_success</code> 内にフレーム化されます。 <code>git psuh</code> がうまく終了せず、どこかで適切な動物について言及していることを確認しましょう:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>test_expect_success 'runs correctly with no args and good output' '
        git psuh &gt;actual &amp;&amp;
        grep Pony actual
'</code></pre>
</div></div>
<div class="paragraph"><p>あなたのスクリプトの下部に以下を追加して、あなたが必要なすべてを実行したことを示します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>test_done</code></pre>
</div></div>
<div class="paragraph"><p>あなたのテストスクリプトを実行可能としてマークしてください:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ chmod +x t/t9999-psuh-tutorial.sh</code></pre>
</div></div>
<div class="paragraph"><p><code>make -C t test-lint</code> を実行すると、新しいテストスクリプトが正常に作成されたかどうかがわかります。これにより、テスト番号の一意性や実行可能ビットなどがチェックされます。</p></div>
</div>
<div class="sect2">
<h3 id="local-test">Running Locally</h3>
<div class="paragraph"><p>ローカルで実行してみましょう:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ make
$ cd t/ &amp;&amp; prove t9999-psuh-tutorial.sh</code></pre>
</div></div>
<div class="paragraph"><p>あなたは完全なテストスイートを実行して、 <code>git-push</code> が何も壊さなかったことを確認できます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ cd t/
$ prove -j$(nproc) --shuffle t[0-9]*.sh</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">これは、 <code>make test</code> を使用して行うことも、TAPを話すことができる任意のテストハーネスを使用することもできます。 <code>prove</code> は同時に実行できます。 <code>shuffle`は、テストが実行される順序をランダム化します。これにより、テスト間の不要な依存関係に対する回復力が高まります。 `prove</code> は出力をより良くする事もします。</td>
</tr></table>
</div>
<div class="paragraph"><p>では、この変更もコミットしておいてください。</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ready-to-share">共有の準備: パッチシリーズの解剖分析</h2>
<div class="sectionbody">
<div class="paragraph"><p>あなたは、 Gitプロジェクトは電子メールで送信されたパッチを介してコード・レビューが行われ、準備が整いコミュニティによって承認されると、メンテナーによって適用されることに、既に気づかれていると思います。 Git プロジェクトはプル・リクエストからの貢献を受け入れません。また、レビューのために電子メールで送信されるパッチは、指定の方法でフォーマットする必要があります。</p></div>
<div class="paragraph"><p>コミットを電子メールで送信されるパッチに変換する方法を検討する前に、最終結果である「パッチ・シリーズ」がどのようになるかを分析してみましょう。 <a href="https://lore.kernel.org/git/pull.1218.git.git.1645209647.gitgitgadget@gmail.com/">例</a> は、 <a href="https://lore.kernel.org/git/">Git mailing list archive</a> のWebインターフェース上のパッチ・シリーズの概要ビューです:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>2022-02-18 18:40 [PATCH 0/3] libify reflog John Cai via GitGitGadget
2022-02-18 18:40 ` [PATCH 1/3] reflog: libify delete reflog function and helpers John Cai via GitGitGadget
2022-02-18 19:10   ` Ævar Arnfjörð Bjarmason [this message]
2022-02-18 19:39     ` Taylor Blau
2022-02-18 19:48       ` Ævar Arnfjörð Bjarmason
2022-02-18 19:35   ` Taylor Blau
2022-02-21  1:43     ` John Cai
2022-02-21  1:50       ` Taylor Blau
2022-02-23 19:50         ` John Cai
2022-02-18 20:00   ` // other replies elided
2022-02-18 18:40 ` [PATCH 2/3] reflog: call reflog_delete from reflog.c John Cai via GitGitGadget
2022-02-18 19:15   ` Ævar Arnfjörð Bjarmason
2022-02-18 20:26     ` Junio C Hamano
2022-02-18 18:40 ` [PATCH 3/3] stash: call reflog_delete from reflog.c John Cai via GitGitGadget
2022-02-18 19:20   ` Ævar Arnfjörð Bjarmason
2022-02-19  0:21     ` Taylor Blau
2022-02-22  2:36     ` John Cai
2022-02-22 10:51       ` Ævar Arnfjörð Bjarmason
2022-02-18 19:29 ` [PATCH 0/3] libify reflog Ævar Arnfjörð Bjarmason
2022-02-22 18:30 ` [PATCH v2 0/3] libify reflog John Cai via GitGitGadget
2022-02-22 18:30   ` [PATCH v2 1/3] stash: add test to ensure reflog --rewrite --updatref behavior John Cai via GitGitGadget
2022-02-23  8:54     ` Ævar Arnfjörð Bjarmason
2022-02-23 21:27       ` Junio C Hamano
// continued</code></pre>
</div></div>
<div class="paragraph"><p>以下の幾つかの点に留意してください:</p></div>
<div class="ulist"><ul>
<li>
<p>
各コミットは、 <em>n</em> コミット シリーズの <em>i</em> 番目のコミットを表す <code>[PATCH _i_/_n_]</code> という接頭辞が付けられたコミット・メッセージのタイトルを件名として、個別の電子メールとして送信されます。
</p>
</li>
<li>
<p>
各パッチは、<code>[PATCH 0/_n_]</code> という接頭辞が付いた、シリーズの、 カバー・レターと呼ばれる紹介メールへの返信として送信されます。
</p>
</li>
<li>
<p>
パッチ・シリーズの後続の反復は、「PATCH」の代わりに「PATCH v2」、「PATCH v3」などのラベルが付けられます。 たとえば、「[PATCH v2 1/3]」は、2 回目の繰り返しの 3 つのパッチの最初のパッチになります。 各反復は新しいカバー・レター (「[PATCH v2 0/3]」など) と共に送信され、それ自体が前の反復のカバー・レターへの返信です(詳細下記)。
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">シングル・パッチ・トピックは、<em>i</em>/<em>n</em> 番号なしで「[PATCH]」、「[PATCH v2]」などで送信されます (ただし、上記の「スレッド概要」では、シングル・パッチ・トピックは表示されません)。</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="cover-letter">The cover letter</h3>
<div class="paragraph"><p>パッチごとの電子メールに加えて、Git コミュニティは、パッチにカバー・レターが付属していることも期待しています。 これは変更提出(change submission)の重要な要素であり、パッチを見るだけではなく、何をしようとしているのか、その理由をコミュニティに高レベルで説明するものです。</p></div>
<div class="paragraph"><p>カバー・レターのタイトルは、トピック・ブランチ全体の目的を簡潔に網羅するものにする必要があります。 コミット・メッセージのタイトルと同じように、しばしば命令調になっています。 シリーズにタイトルを付ける方法は以下のとおりです:</p></div>
<div class="paragraph"><p>---
Add the <em>psuh</em> command
---</p></div>
<div class="paragraph"><p>カバー・レターの本文は、レビュー担当者に追加のコンテキストを提供するために使用されます。 パッチだけでは明らかにならないことは必ず説明してください。 ただし、カバー・レターはコミット履歴に記録されないため、将来リポジトリの履歴を読む人にとって役立つ可能性があるものはコミット・メッセージにも記載する必要があることを忘れないでください。</p></div>
<div class="paragraph"><p>ここで、 <code>push</code> の本文の例を以下に示します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Our internal metrics indicate widespread interest in the command
git-psuh - that is, many users are trying to use it, but finding it is
unavailable, using some unknown workaround instead.

The following handful of patches add the psuh command and implement some
handy features on top of it.

This patchset is part of the MyFirstContribution tutorial and should not
be merged.</code></pre>
</div></div>
<div class="paragraph"><p>ここから、 パッチ・セットをフォーマットしてレビューを受けるための 2 つの異なる方法を示すために、チュートリアルは分岐します。</p></div>
<div class="paragraph"><p>一番目の方法はGitGitGadgetです。これは、GitHubの一般的なプルリクエストワークフローに既に精通しているユーザーに役立ちます。 この方法ではGitHubアカウントが必要です。</p></div>
<div class="paragraph"><p>2番目の方法は <code>git send-email</code> にて対応します。これにより、送信する電子メールを少し細かく制御できます。 この方法には、システムに応じて変更される可能性のあるいくつかの設定が必要であり、このチュートリアルでは説明しません。</p></div>
<div class="paragraph"><p>どちらの方法を選択しても、レビュー担当者との関わりは同じです。 レビュープロセスについては、GitGitGadget と <code>git send-email</code> のセクションの後で説明します。</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto-ggg">Sending Patches via GitGitGadget</h2>
<div class="sectionbody">
<div class="paragraph"><p>パッチを送信するためのオプションの一つは、一般的なプルリクエストワークフローに従い、GitGitGadgetを介してパッチを送信することです。 GitGitGadgetは、GitHub PRワークフローに慣れている人にとって、Git寄稿者としての生活を容易にするために Johannes Schindelin によって作成されたツールです。 これにより、寄稿者はGitプロジェクトのミラーに対してプルリクエストを開くことができ、PRを一連の電子メールに変換して送信するための魔法を実行します。 また、Git継続的インテグレーションスイートも実行します。 これは <a href="http://gitgitgadget.github.io">http://gitgitgadget.github.io</a> で文書化されています。</p></div>
<div class="sect2">
<h3 id="create-fork">Forking <code>git/git</code> on GitHub</h3>
<div class="paragraph"><p>あなたはGitGitGadgetを使用してレビューするためにパッチを送信する前に、Gitプロジェクトをフォークして変更をアップロードする必要があります。 まず最初に、GitHubアカウントを持っていることを確認してください。</p></div>
<div class="paragraph"><p><a href="https://github.com/git/git">GitHub mirror</a> に移動し、フォークボタン(Fork button)を探します。 あなたの適切と思われる場所にあなたのフォークを配置作成します。</p></div>
</div>
<div class="sect2">
<h3 id="upload-to-fork">Uploading to Your Own Fork</h3>
<div class="paragraph"><p>ブランチを自分のフォークにアップロードするには、新しいフォークをリモートとして追加する必要があります。 <code>git remote -v</code> を使用して、すでに追加したリモートを表示できます。 GitHubの新しいフォークのページから、「Clone or download」(クローンまたはダウンロード)を押してURLを取得できます。 次に、以下を実行してリモートを追加し、提供されている例の独自のURLとリモート名を置き換える必要があります:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git remote add remotename git@github.com:remotename/git.git</code></pre>
</div></div>
<div class="paragraph"><p>または、HTTPS URL を使って:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git remote add remotename https://github.com/remotename/git/.git</code></pre>
</div></div>
<div class="paragraph"><p>もう一度 <code>git remote -v</code> を実行すると、新しいリモートが表示されます。 プッシュの準備をするために、 <code>git fetch remotename</code> (remotenameの部分はあなたの実際のリモートの名前に置き換えて下さい) とします。</p></div>
<div class="paragraph"><p>次に、 <code>git branch</code> を実行して、あなたの全ての開発を新しいブランチで行っていることを再確認します。 そうでない場合は、今が新しいコミットを独自のブランチに移動する良い機会です。</p></div>
<div class="paragraph"><p>このドキュメントの冒頭で簡単に説明したように、作業は <code>master</code> に基づいているため、以下に示すように更新しておくか、好みのワークフローを使用してください。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git checkout master
$ git pull -r
$ git rebase master psuh</code></pre>
</div></div>
<div class="paragraph"><p>そして今や、あなたは新しいトピックブランチをプッシュする準備が整いました！ (ブランチ名をあなたの実際のに置き換えるのと、あなたのコマンド名がpushじゃなくてpsuhであることに注意して下さい。)</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git push remotename psuh</code></pre>
</div></div>
<div class="paragraph"><p>これで、あなたはGitHubで新しく作成したブランチにアクセスして確認できるようになります。</p></div>
</div>
<div class="sect2">
<h3 id="send-pr-ggg">Sending a PR to GitGitGadget</h3>
<div class="paragraph"><p>コードをテストしてレビュー用にフォーマットするには、まず、 <code>gitgitgadget/git</code> に対してプルリクエストを開く必要があります。 <a href="https://github.com/gitgitgadget/git">https://github.com/gitgitgadget/git</a> にアクセスし、「New pull request」(新しいプルリクエスト)ボタンまたは、新しくプッシュしたブランチの名前とともに表示される便利な「Compare &amp; pull request」(比較してプルリクエスト)ボタンを使用してPRを開きます。</p></div>
<div class="paragraph"><p>PR のタイトルと説明を確認してください。 GitGitGadget では、あなたの変更の、カバー・レターの件名と本文としてそれぞれ使用されます。 提出物にタイトルを付ける方法と説明に含める内容については、上記 <a href="#cover-letter">"The cover letter"</a> を参照してください。</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">単一パッチでの貢献の場合、あなたのコミット・メッセージはすでに意味のある内容があり、それはパッチの目的 (何が起こっているのか、その理由) を高レベルで説明しているべきであるため、通常は追加のコンテキストは必要ありません。 その場合、 GitHub がコミット・メッセージから自動的に生成する PR の説明を削除します (PR の説明は空にする必要があります)。 さらに多くのコンテキストを提供する必要がある場合は、その場所で行うことができ、GitGitGadget が送信する電子メールの三点鎖線(three-dash)と diffstat の間に追加されます (送信後の様子については <a href="#single-patch">Bonus Chapter: One-Patch Changes</a> を参照してください)。</td>
</tr></table>
</div>
<div class="paragraph"><p>満足したら、プル・リクエストを送信します。</p></div>
</div>
<div class="sect2">
<h3 id="run-ci-ggg">Running CI and Getting Ready to Send</h3>
<div class="paragraph"><p>あなたがGitGitGadgetを初めて使用する場合(このチュートリアルを使用している可能性が高い)、誰かがツールの使用許可を与える必要があります。 GitGitGadgetのドキュメントに記載されているように、PRに <code>/allow&lt;username&gt;</code> を付けてコメントするにはすでにそれを使用している人が必要です。 GitGitGadgetは、許可が与えられていなくてもCIを介してPRを自動的に実行しますが、誰かがあなたにツールの使用を許可するまで、あなたの変更を <code>/submit</code> することはできません。</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">通常、GitGitGadgetであなたを <code>/allow</code> できる人を見つけるには、誰かに <code>/allow</code> が付与されている最近のプルリクエストを調べます(<a href="https://github.com/gitgitgadget/git/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+is%3Aopen+%22%2Fallow%22">Search: is:pr is:open "/allow"</a>)。この場合、作成者と <code>/allow</code> を付与した人の両方が <code>/allow</code> できるようになります。 <code>/allow</code> するか、またはLiberaChatの <a href="https://web.libera.chat/#git-devel">#git-devel</a> IRCチャネルで、プルリクエストをリンクして誰かに <code>/allow</code> するように依頼してください。</td>
</tr></table>
</div>
<div class="paragraph"><p>CIに失敗した場合は、 <code>git rebase -i</code> を使用して変更を更新し、ブランチを再度プッシュできます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git push -f remotename psuh</code></pre>
</div></div>
<div class="paragraph"><p>実際、パッチが <code>next</code> に受け入れられるまで、この方法で変更を続ける必要があります。</p></div>
</div>
<div class="sect2">
<h3 id="send-mail-ggg">Sending Your Patches</h3>
<div class="paragraph"><p>あなたのCIを通過し、誰かが <code>/allow</code> コマンドでGitGitGadgetを使用する許可を与えたのなら、レビューのために送信するのは、<code>/submit</code> でPRにコメントするのと同じくらい簡単です。</p></div>
</div>
<div class="sect2">
<h3 id="responding-ggg">Updating With Comments</h3>
<div class="paragraph"><p>メーリングリストで受け取るレビューコメントに返信する方法については、 <a href="#reviewing">Responding to Reviews</a> に進んでください。</p></div>
<div class="paragraph"><p>すべてのレビューコメントに従って希望の形でブランチを作成したら、もう一度送信できます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git push -f remotename psuh</code></pre>
</div></div>
<div class="paragraph"><p>次に、GitGitGadgetに対するプルリクエストを確認します。 CIが再び開始されたことがわかります。 CIの実行中に、プルリクエストスレッドの上部にある説明を変更するのに適したタイミングです。 カバーレターとして再び使用されます。 この場所を使用して、以前のバージョンから何が変更されたかを説明し、レビュー担当者が何を見ているのかをある程度把握できるようにする必要があります。 CIの実行が完了したら、 <code>/submit</code> でもう一度コメントできます。GitGitGadgetはあなたの変更にv2マークを自動的に追加します。</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="howto-git-send-email">Sending Patches with <code>git send-email</code></h2>
<div class="sectionbody">
<div class="paragraph"><p>GitGitGadgetを使用したくない場合は、Git自体を使用してパッチをメールで送信することもできます。 このようにGitを使用する利点には、件名をよりきめ細かく制御できること(たとえば、件名に [RFC PATCH]のタグを使用できること)や、メーリングリストに投稿する前に自分用の「ドライラン」メールを送ってすべてがうまくいくことを確認できることがあります。</p></div>
<div class="sect2">
<h3 id="setup-git-send-email">Prerequisite: Setting Up <code>git send-email</code></h3>
<div class="paragraph"><p>send-email` の設定はオペレーティングシステムやメールプロバイダーによって異なるので、このチュートリアルでは説明しません。 多くのLinuxディストリビューションでは、 <code>git-send-email</code> は通常の <code>git</code> インストールと一緒にパッケージされていません。 追加パッケージをインストールする必要があるかもしれません。 オンラインには、そのためのリソースがたくさんあります。 また、SMTPサーバーを使用するための正しい設定方法を決定する必要があります。 この設定はシステムやメールの設定によって大きく変わる可能性があるので、このチュートリアルの範囲外です。</p></div>
</div>
<div class="sect2">
<h3 id="format-patch">Preparing Initial Patchset</h3>
<div class="paragraph"><p>Gitを使用したメールの送信は2つの部分からなるプロセスです。 メール自体を準備する前に、パッチを準備する必要があります。 幸いなことに、これは非常に簡単です:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git format-patch --cover-letter -o psuh/ --base=auto psuh@{u}..psuh</code></pre>
</div></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
<code>--cover-letter</code> オプションは、<code>format-patch</code> にカバーレターのテンプレート・ファイルを作成するように指示します。 あなたは送信前にテンプレートに記入する必要があります。 しかし、今のところ、そのテンプレート・ファイルは他のパッチ・ファイルと一緒にあります。
</p>
</li>
<li>
<p>
<code>-o psuh /</code> オプションは、パッチファイルをディレクトリに配置するように <code>format-patch</code> に指示します。 <code>git send-email</code> はディレクトリを取得し、そこからすべてのパッチを送信できるため、これは便利です。
</p>
</li>
<li>
<p>
<code>--base=auto</code> オプションは、受信者が一連のパッチを適用すると予想されるベース・コミットを記録するようにコマンドに指示します。 <code>auto</code> 値の指定により、 <code>format-patch</code> はベース・コミットを自動的に計算します。これは、リモート追跡ブランチの先端コミットのマージ・ベースと指定されたリビジョン範囲です。
</p>
</li>
<li>
<p>
<code>psuh@{u}..psuh</code> オプションは <code>format-patch</code> に、上流(「Set up your workspace」セクションの例に従った場合、これは <code>origin/master</code> です)から分岐したので <code>psuh</code> ブランチ(訳注: push ではなくて psuh)で作成したコミット用のパッチを生成するように指示します。 既に <code>psuh</code> ブランチにいる場合は、 単に <code>@{u}</code> と言うことができます。これは、「上流から分岐したため、現在のブランチでコミットする」ことを意味し、同じことを意味します。
</p>
</li>
</ol></div>
<div class="paragraph"><p>このコマンドは、コミットごとに 1 つのパッチ・ファイルを作成します。 実行した後、お気に入りのテキスト・エディタで各パッチを調べて、すべてが適切に表示されることを確認できます。 ただし、パッチ・ファイルを使用してコードを修正することはお勧めしません。 パッチを変更するよりも、<code>git rebase -i</code> を使用するか、新しいコミットを追加することによって、通常の方法で変更を加える方が良い考えです。</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">オプションで、 <code>--rfc</code> フラグを使用して、パッチの件名の前に 「[PATCH]」ではなく「[RFCPATCH]」を付けることもできます。 RFCは「request for comments」の略で、コードを送信する準備が整っていないときに、コードレビュープロセスを開始することを示しています。 これは、パッチが提案である場合にも使用できますが、コミュニティがそのアプローチで問題を解決したいかどうか、つまり一種の設計レビューを実施したいかどうかはわかりません。 「WIP」とマークされたパッチもリストに表示される場合があります。これは、パッチが不完全であることを意味しますが、レビュー担当者にこれまでのパッチを確認してもらいたいことを意味します。 このフラグは <code>--subject-prefix=WIP</code> で追加できます。</td>
</tr></table>
</div>
<div class="paragraph"><p>パッチとカバーレターのテンプレートが指定したディレクトリに存在することを確認してください。これであなたがレビューを送信する準備がほぼ整いました！</p></div>
</div>
<div class="sect2">
<h3 id="preparing-cover-letter">Preparing Email</h3>
<div class="paragraph"><p><code>--cover-letter</code> を指定して <code>format-patch</code> を呼び出したので、カバー・レターのテンプレートは既に用意されています。 それをお気に入りのエディターで開きます。</p></div>
<div class="paragraph"><p>あなたは既に多数のヘッダーを拝んでいるはずです。 <code>From:</code> ヘッダーが正しいことを確認してください。 その次に、<code>Subject:</code> を変更します(パッチシリーズに適切なタイトルを選ぶには、 <a href="#cover-letter">上記</a> を参照してください):</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Subject: [PATCH 0/7] Add the 'psuh' command</code></pre>
</div></div>
<div class="paragraph"><p>必ず ”[PATCH 0/X]” の部分を保持してください。 これが、このメールがパッチ・シリーズの始まりであることをGitコミュニティに示しており、多くのレビュー担当者がこのタイプのフラグでメールをフィルタリングしています。</p></div>
<div class="paragraph"><p>あなたはカバーレターを追加するために <code>git send-email</code> を呼び出すときに、いくつかの追加パラメーターを追加する必要があります。</p></div>
<div class="paragraph"><p>次に、カバーレターの本文を記入する必要があります。 繰り返しますが、含める内容については <a href="#cover-letter">above</a> を参照してください。</p></div>
<div class="paragraph"><p><code>git format-patch --cover-letter</code> によって作成されたテンプレートには、diffstatが含まれています。 これにより、レビュー担当者は、トピックをレビューするときに何をしているのかを要約できます。 サンプル実装から <code>psuh</code> 用に生成されたものは以下のようになります:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> Documentation/git-psuh.txt | 40 +++++++++++++++++++++
 Makefile                   |  1 +
 builtin.h                  |  1 +
 builtin/psuh.c             | 73 ++++++++++++++++++++++++++++++++++++++
 git.c                      |  1 +
 t/t9999-psuh-tutorial.sh   | 12 +++++++
 6 files changed, 128 insertions(+)
 create mode 100644 Documentation/git-psuh.txt
 create mode 100644 builtin/psuh.c
 create mode 100755 t/t9999-psuh-tutorial.sh</code></pre>
</div></div>
<div class="paragraph"><p>最後に、この手紙文にはパッチの生成に使用されたGitのバージョンが含まれます。 この文字列は放っておいても大丈夫です。</p></div>
</div>
<div class="sect2">
<h3 id="sending-git-send-email">Sending Email</h3>
<div class="paragraph"><p>この時点で、パッチとカバーレターが入ったディレクトリ <code>psuh/</code> が作成されているはずです。 あなたがそれを送信する時が来ました！ あなたは以下のように送信できます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git send-email --to=target@example.com psuh/*.patch</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">返信先アドレスの変更やCCおよびBCC行の追加など、役立つと思われるその他のオプションについては、 <code>git help send-email</code> を確認してください。</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">実際のパッチを送信する場合、 <a href="mailto:git@vger.kernel.org">git@vger.kernel.org</a> に送信されますが、チュートリアルから実際のメーリングリストにパッチセットを送信しないでください。 今のところ、それがどのように見えるかを確実に理解するために、それを自分自身に送信することができます。</td>
</tr></table>
</div>
<div class="paragraph"><p>あなたが上記のコマンドを実行すると、各パッチが送信されるたびにインタラクティブなプロンプトが表示されます。 これにより、何かを編集したり送信をやめたりする最後のチャンスが得られます(ただし、繰り返しになりますが、この方法でコードを編集してはいけません)。 これらのプロンプトで <code>y</code> または <code>a</code> を押すと、メールが送信されます！ おめでとうございます！</p></div>
<div class="paragraph"><p>素晴らしい！これでコミュニティはすべてを捨ててあなたの変更をレビューすることでしょう。 (冗談です、我慢が肝要です)</p></div>
</div>
<div class="sect2">
<h3 id="v2-git-send-email">Sending v2</h3>
<div class="paragraph"><p>このセクションでは、あなたのパッチセットの v2 を送信する方法に焦点を当てます。 v2 に何を含める必要があるかについては、 <a href="#reviewing">Responding to Reviews</a> にスキップして、レビュー担当者からのコメントの処理方法を確認してください。</p></div>
<div class="paragraph"><p>v2 の「psuh」トピック ブランチを再利用します。 変更を加える前に、簡単に参照できるように v1 ブランチの先端をマークします:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git checkout psuh
$ git branch psuh-v1</code></pre>
</div></div>
<div class="paragraph"><p>レビュアーのコメントに基づいてコミットを調整するには、 <code>git rebase -i</code> を使用してパッチ・シリーズを改良します。 パッチ・シリーズを送信する準備ができたら、パッチを再度生成しますが、いくつかの新しいフラグを使用します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git format-patch -v2 --cover-letter -o psuh/ --range-diff master..psuh-v1 master..</code></pre>
</div></div>
<div class="paragraph"><p><code>--range-diff master..psuh-v1</code> パラメータは、カバー・レターに <code>psuh-v1</code> と <code>psuh</code> の間の範囲差分(range-diff)を含めるように <code>format-patch</code> に指示します (<a href="git-range-diff.html">git-range-diff(1)</a> 参照)。 これは、v1 パッチと v2 パッチの違いをレビュアーに伝えるのに役立ちます。</p></div>
<div class="paragraph"><p><code>-v2</code> パラメータは、パッチをバージョン「2」として出力するように <code>format-patch</code> に指示します。 たとえば、v2 パッチはすべて <code>v2-000n-my-commit-subject.patch</code> のような名前になっていることに気付くかもしれません。 <code>-v2</code> は、<code>[PATCH]</code> の代わりに <code>[PATCH v2]</code> をプレフィックスとしてパッチをフォーマットし、 range-diff は <code>Range-diff against v1</code> で始まります。</p></div>
<div class="paragraph"><p>このコマンドを実行すると、 <code>format-patch</code> は v1 パッチと一緒に <code>psuh/</code> ディレクトリにパッチを出力します。 単一のディレクトリを使用すると、v2 パッチを校正しながら古い v1 パッチを簡単に参照できますが、v2 パッチのみを送信するように注意する必要があります。 <code>psuh/v2-*.patch</code> のようなパターンを使用します (v1 および v2 パッチに一致する <code>psuh/*.patch</code> ではありません)。</p></div>
<div class="paragraph"><p>カバーレターをもう一度編集します。 何か重要なことがあれば、今が前回のバージョンと現在のバージョンの違いについて言及する良い機会です。 2番目のカバーレターにまったく同じ本文は必要ありません。 レビューアの目に見えない可能性のある変更を説明することに焦点を当てます。</p></div>
<div class="paragraph"><p>また、あなたはカバーレターのメッセージ ID を見つけなければなりません。 最初のシリーズを送信するときに <code>git send-email</code> の出力をメモしておくができますし、 <a href="https://lore.kernel.org/git">mailing list</a> で調べることもできます。アーカイブでカバーレターを見つてクリックし、 そして "permalink" または "raw" をクリックすると、 以下のような Message-ID ヘッダーが表示されます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Message-ID: &lt;foo.12345.author@example.com&gt;</code></pre>
</div></div>
<div class="paragraph"><p>あなたのメッセージIDは <code>&lt;foo.12345.author@example.com&gt;</code> です。 この文章では以降、この例を使います。 <strong>previous cover letter</strong> を正しいメッセージIDに置き換えてください。つまり、v2を送信する場合は、v1からのMessage-IDを使用します。 v3を送信する場合は、v2からのMessage-Idを使用します。</p></div>
<div class="paragraph"><p>メーリングリストではすべてのCCをスレッドに保持するのが一般的であるため、電子メールを見ている間、誰がCCされているかにも注意する必要があります。 これらのCC行は、ヘッダー(件名行の前)に以下のような行を使用して、カバーレターに直接追加できます:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>CC: author@example.com, Othe R &lt;other@example.com&gt;</code></pre>
</div></div>
<div class="paragraph"><p>コマンドに渡すメッセージに細心の注意を払いながら、もう一度メールを送信します:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>$ git send-email --to=target@example.com
                 --in-reply-to="&lt;foo.12345.author@example.com&gt;"
                 psuh/v2-*.patch</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="single-patch">Bonus Chapter: One-Patch Changes</h3>
<div class="paragraph"><p>場合によっては、あなたのごくわずかな変更が1つのパッチのみで構成されていることがあります。 その場合、送信する必要があるのは1通のメールだけです。 コミットメッセージはすでに意味があり、パッチの目的(何が起こっているのか、その理由)を高レベルで説明しているはずですが、さらに多くのコンテキストを提供する必要がある場合は、パッチの <code>---</code> の下で行うことができます。 以下の例を見てください。これは、1回のコミットで <code>git format-patch</code> を使用して生成され、編集されて、 <code>---</code> とdiffstatの間にコンテンツが追加されています。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>From 1345bbb3f7ac74abde040c12e737204689a72723 Mon Sep 17 00:00:00 2001
From: A U Thor &lt;author@example.com&gt;
Date: Thu, 18 Apr 2019 15:11:02 -0700
Subject: [PATCH] README: change the grammar

I think it looks better this way. This part of the commit message will
end up in the commit-log.

Signed-off-by: A U Thor &lt;author@example.com&gt;
---
Let's have a wild discussion about grammar on the mailing list. This part of my email will never end up in the commit log. Here is where I can add additional context to the mailing list about my intent, outside of the context of the commit log. This section was added after `git format-patch` was run, by editing the patch file in a text editor.

 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/README.md b/README.md
index 88f126184c..38da593a60 100644
--- a/README.md
+++ b/README.md
@@ -3,7 +3,7 @@
 Git - fast, scalable, distributed revision control system
 =========================================================

-Git is a fast, scalable, distributed revision control system with an
+Git is a fast, scalable, and distributed revision control system with an
 unusually rich command set that provides both high-level operations
 and full access to internals.

--
2.21.0.392.gf8f6787159e-goog</code></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="now-what">My Patch Got Emailed - Now What?</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="reviewing">Responding to Reviews</h3>
<div class="paragraph"><p>うまくいけば、数日後にはあなたのパッチセットへのコメント付きの返信が届くことでしょう。 やったね！ まぁともあれ、これであなたは本来の作業に戻ることができます。</p></div>
<div class="paragraph"><p>それぞれのコメントには、提案された変更を行ったこと、オリジナルの方が良いと思ったこと、あるいはコメントによって新しい方法を思いついたこと(オリジナルと提案された変更の両方が優れている) をレビュアーに知らせるのが良いマナーです。こうすることで、査読者は、あなたがコメントした事を実装したかどうかを判断するために、あなたのV2を検査する必要がなくなります。</p></div>
<div class="paragraph"><p>査読者は、提案されたコミットログメッセージまたは変更自体のいずれかで、パッチセットに何を書き込んだかについて質問する場合があります。 応答メッセージでこれらの質問に答える必要がありますが、多くの場合、レビュー担当者が、あなたが何を書くつもりかを理解するためにこれらの質問をした理由は、パッチセットを理解するために説明が必要だったためです。</p></div>
<div class="paragraph"><p>レビュアーの質問に答えて、レビュアーが「言いたいことがわかった」と言うだけで、満足してはいけないのです。 レビュアーが困っている点を明確にするためにパッチを更新し、v2を準備します。v1でレビュアーからの質問に答えるために使った言葉が、役に立つかもしれません。 あなたの目標は、v2を十分に明確にして、次に読む人に同じ説明をする必要がなくなるようにすることです。</p></div>
<div class="paragraph"><p>コメントに対して反論する場合は、礼儀正しく、なぜあなたのオリジナルの方が良いと思うのかを説明します。レビュアーがまだあなたに同意しないかもしれないことや、コミュニティの他のメンバーが双方の側に意見するかもしれないことを覚悟してください。他のレビュアーは、あなたとは異なる視点でプロジェクトを見ており、あなたには思いもよらなかったような副作用について考えているかもしれません。なぜその変更が提案されたのか、あるいは査読者があなたに何を求めているのかがわからない場合は、いつでも説明を求めてかまいません。</p></div>
<div class="paragraph"><p>あなたの電子メールクライアントにプレーンテキストの電子メールモードがあり、オンになっていることを確認してください。 GitメーリングリストはHTMLメールを拒否します。 <a href="https://kernel.googlesource.com/pub/scm/git/git/+/todo/MaintNotes">Maintainer&#8217;s Note</a> で概説されているメーリングリストのエチケットにも従ってください。 これは、ボトムポストやインラインリプライに関するほとんどのオープンソースコミュニティのエチケットルールに似ています。</p></div>
<div class="paragraph"><p>コードに変更を加える場合、 <code>git rebase -i</code> (対話的リベース)を使用すると、最もクリーンになります。つまり、結果のコミットが最も見やすくなります。 O&#8217;Reillyの <a href="https://www.oreilly.com/library/view/git-pocket-guide/9781449327507/ch10.html">overview</a> ご覧ください。 一般的な考え方は、変更が必要な各コミットを変更することです。 このようにすると、v1では間違いのあるパッチAと、問題なく上流のレビューも必要ないパッチBと、v2ではパッチAを修正したパッチC、を用意する代わりに、正しいパッチAと正しいパッチBでv2を出荷すればいいのです。これは履歴を変更していますが、誰とも共有していないローカル履歴なので、今のところは問題ありません。 (後でこれを行うのは意味がない場合があります。コンテキストについては、次のセクションを参照してください。)</p></div>
</div>
<div class="sect2">
<h3 id="after-approval">After Review Approval</h3>
<div class="paragraph"><p>Gitプロジェクトには、 <code>seen</code> と <code>next</code> と <code>master</code> と <code>maint</code> の4つの統合ブランチがあります。 変更は、レビュープロセスの途中で、メンテナによってかなり早い段階で「seen」(表示)されます。 そこから、より広範なテストの準備ができたら、<code>next</code> にマージされます。 多くの初期のテスターは <code>next</code> を使用し、問題を報告する可能性があります。 最終的に、 <code>next</code> を変更すると、通常は安定していると見なされる <code>master</code> になります。 最後に、新しいリリースが出ると、 <code>maint</code> がバグ修正のベースとして使用されます。 このドキュメントの冒頭で述べたように、さまざまな統合ブランチの使用に関する詳細については、「Documents/SubmittingPatches」を参照してください。</p></div>
<div class="paragraph"><p>話を戻します。 今や、 あなたのコードは上流のレビューアから賞賛されています。 あなたのコードは完璧で、 受け入れられる準備ができています。 他に何もする必要はありません。 メンテナはトピックブランチを <code>next</code> にマージし、最高な気分ですおすし。</p></div>
<div class="paragraph"><p>しかしながら、この時点以降に完全ではないことにあなたが気付いた場合は、あなたがプロセスのどこにいるかに応じて、いくつかの特別な手順を実行する必要があります。</p></div>
<div class="paragraph"><p>メンテナが「What&#8217;s cooking in git.git」メールで、あなたのトピックに「next」のマークが付けられていることを発表した場合、つまり、トピックを「next」にマージする予定であるが、まだマージしていない場合は、 メンテナにもう少し待つように依頼するメールを送るべきです: 「シリーズのv4を送信し、 <code>next</code> のマークを付けましたが、これを変更する必要があります。v5を待ってからマージしてください。」</p></div>
<div class="paragraph"><p>トピックがすでに <code>next</code> にマージされている場合は、<code>git rebase -i</code> でパッチを修正するのではなく、インクリメンタルに、つまり <a href="https://github.com/gitster/git">https://github.com/gitster/git</a> にあるようにメンテナのトピックブランチを基点として別のコミットで変更を加えてください。 あなたの仕事はまだ同じトピックにありますが、トピックブランチの大規模な書き直しではなく、インクリメンタルになっています。</p></div>
<div class="paragraph"><p>メンテナのGitHubのトピックブランチはGitGitGadgetにミラーリングされているため、レビューをそのように送信する場合は、適切なGitGitGadget/Gitブランチに対してPRを開く必要があります。</p></div>
<div class="paragraph"><p><code>git send-email</code> を使用している場合は、以前と同じように使用できますが、 <code>&lt;topic&gt;..&lt;mybranch&gt;</code> からdiffを生成し、 <code>master</code> の代わりに <code>&lt;topic&gt;</code> に基づいて作業する必要があります。</p></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2023-07-22 15:44:06 JST
</div>
</div>
</body>
</html>
