<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 9.1.1" />
<title>How to maintain Git</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overridden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>How to maintain Git</h1>
<span id="revdate">2023-07-22</span>
</div>
<div id="content">
<div class="sect1">
<h2 id="_activities">Activities</h2>
<div class="sectionbody">
<div class="paragraph"><p>メンテナのGit作業時間は、3つのアクティビティに費やされます。</p></div>
<div class="ulist"><ul>
<li>
<p>
コミュニケーション (45%)
</p>
<div class="paragraph"><p>一般的な設計、ユーザーの質問への回答、バグレポートの診断に関するメーリングリストでのディスカッション。パッチのレビューや、コメントや、代替案の提案や、パッチの拒否。</p></div>
</li>
<li>
<p>
インテグレーション(統合) (50%)
</p>
<div class="paragraph"><p>貢献者からの新しいパッチを適用しながら、小さな間違いを見つけて修正し、統合ブランチとテストブランチを混ぜっ返し、結果をプッシュし、リリースを区切り、アナウンスを行います。</p></div>
</li>
<li>
<p>
自身の開発作業 (5%)
</p>
<div class="paragraph"><p>自身が思う痒い所に手を入れ、提案パッチシリーズを送信します。</p></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_the_policy">The Policy</h2>
<div class="sectionbody">
<div class="paragraph"><p>統合に関するポリシーは、「A Note from the maintainer」メッセージに非公式に記載されています。このメッセージは、各機能のリリースが行われた後、このメーリングリストに定期的に投稿されます。</p></div>
<div class="ulist"><ul>
<li>
<p>
機能リリースには vX.Y.0 の番号が付けられており、機能、パフォーマンス、使いやすさなど、あらゆる分野でのバグ修正と機能拡張が、デグレ無しで含まれることを目的としています。
</p>
</li>
<li>
<p>
機能リリースのリリースサイクルは、8〜10週間と想定されています。
</p>
</li>
<li>
<p>
メンテナンスリリースにはvX.Y.Zという番号が付けられており、対応する vX.Y.0 機能リリースと以前のメンテナンスリリース vX.Y.W(W&lt;Z) の、バグ修正のみが含まれていることを意味します。
</p>
</li>
<li>
<p>
「master」ブランチは、次の機能リリースの準備に使用されます。 つまり、ある時点で、「master」ブランチの先端に vX.Y.0 のタグが付けられます。
</p>
</li>
<li>
<p>
「maint」ブランチは、次のメンテナンスリリースの準備に使用されます。 機能リリース vX.Y.0 が作成された後、「maint」ブランチの先端がそのリリースに設定され、バグ修正がブランチに蓄積され、ある時点で、ブランチの先端に vX.Y.1, vX.Y.2, 等のタグが付けられます。
</p>
</li>
<li>
<p>
「next」ブランチは、 (1)価値のある目標があり、 (2)日常の使用に適したかなり良好な状態であり、 (3)デグレがないことがまだ実証されていない変更(拡張と修正の両方)を公開するために使用されます。 新しい変更は、「master」にマージされる前に「next」でテストされます。
</p>
</li>
<li>
<p>
「seen」ブランチは、「next」に設定された基準をまだパスしていない他の提案された変更を公開するために使用されます。
</p>
</li>
<li>
<p>
「master」と「maint」ブランチの先端は、人々がそれらの上に独自のカスタマイズを構築できるようにするために、巻き戻されることはありません。 新しい開発サイクルの早い段階で、「next」は「master」の先端に一度巻き戻されますが、それ以外の場合は、サイクルが終了するまで巻き戻されません。
</p>
</li>
<li>
<p>
通常、「master」には「maint」のすべてが含まれ、「next」には「master」のすべてが含まれます。 「seen」には「next」にマージされたすべてのトピックが含まれていますが、「master」で直接再構築されています。
</p>
</li>
<li>
<p>
「master」の先端は、タグ付けされたどのリリースよりも安定していることを意味しており、ユーザーはそれに従うことをお勧めします。
</p>
</li>
<li>
<p>
「next」ブランチは新しいアクションが行われる場所であり、新しいトピックが「master」にマージされる前にデグレとバグが見つかるように、ユーザーはそれをテストすることをお勧めします。
</p>
</li>
</ul></div>
<div class="paragraph"><p>注意: v1.9.0リリース以前は、バージョン番号の構造が少し異なっていたことに注意してください。 vX.Y.Z は機能リリースであり、vX.Y.Z.W は vX.Y.Z のメンテナンスリリースでした。</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_a_typical_git_day">A Typical Git Day</h2>
<div class="sectionbody">
<div class="paragraph"><p>メンテナの典型的なGitな一日は、以下のようにして上記のポリシーを実装します:</p></div>
<div class="ulist"><ul>
<li>
<p>
メーリングリストを走査します。 レビューコメント、提案などで返信します。あちこちの議論にクチバシを突っ込みます(Kibitz)。 メーリングリストから潜在的に使用可能なパッチを収集します。 1つのトピックに関するパッチは1つのメールボックスに送信されます(私はGnusでメールを読み、<code>\C-o</code> と入力して、メッセージをmbox形式のファイルに 保存/追加 します)。
</p>
</li>
<li>
<p>
メーリングリストで提起されたが、誰も解決に乗り出していない問題に対処するために自身でパッチを書きます。 他の貢献者と同じように送信し、他の貢献者からのパッチと同じように受け取ります(上記参照)。
</p>
</li>
<li>
<p>
保存したメールボックスのパッチを確認します。タイプミス修正と、プログラムをキレイにするために提案されたログメッセージを編集し、リストから収集した対応を追加します。 パッチを編集して、ディスカッションからの「ええっと、これはこのようになっているはずです」な修正を組み込みます。
</p>
</li>
<li>
<p>
収集されたパッチを分類し、 <code>master</code> と <code>maint</code> の更新を処理します:
</p>
<div class="ulist"><ul>
<li>
<p>
明らかに、「maint」の先端に関連する正しい修正は、「maint」に直接適用されます。
</p>
</li>
<li>
<p>
明らかに、「master」の先端に関連する正しい修正は、「master」に直接適用されます。
</p>
</li>
<li>
<p>
他のトピックはこのステップでは処理されません。
</p>
<div class="paragraph"><p>このステップは 「git am」で実行されます。</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout master    ;# or "git checkout maint"
$ git am -sc3 mailbox
$ make test</code></pre>
</div></div>
<div class="paragraph"><p>実際には、 <code>master</code> または <code>maint</code> に直接行くパッチはほとんどありません。</p></div>
</li>
</ul></div>
</li>
<li>
<p>
「What&#8217;s cooking」メッセージの最後の号を確認し、マージの準備ができているトピックを確認します(topic→master と topic→maint)。 このステップを支援するために、 <code>Meta/cook -w</code> スクリプト( Meta/ には「todo」ブランチのチェックアウトが含まれています)を使用します。
</p>
<div class="paragraph"><p>そして、マージを実行します。 この手順を支援するには、 <code>Meta/Reintegrate -e</code> スクリプト(後述)を使用します。</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ Meta/cook -w last-issue-of-whats-cooking.mbox</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout master    ;# or "git checkout maint"
$ echo ai/topic | Meta/Reintegrate -e ;# "git merge ai/topic"
$ git log -p ORIG_HEAD.. ;# final review
$ git diff ORIG_HEAD..   ;# final review
$ make test              ;# final review</code></pre>
</div></div>
</li>
<li>
<p>
残りのパッチを処理します:
</p>
<div class="ulist"><ul>
<li>
<p>
「master」に適用可能で(つまり、「next」にあり、「master」にないものに依存しません)明らかでないものはすべて、「master」の先端から分岐した新しいトピックブランチ(または「master」より少し古い最後の機能リリース)に適用されます。これには、「master」の機能強化と明らかでない修正の両方が含まれます。 トピックブランチの名前は ai/topic です。ここで、「ai」は作成者の頭文字にちなんで名付けられた2文字の文字列であり、「topic」はトピックの説明的な名前です(つまり、「そのシリーズが何に付いてであるか」です)。
</p>
</li>
<li>
<p>
「maint」を対象とした明白でない修正が、「maint」の先端から分岐した新しいトピックブランチ(または最も古く、まだ関連するメンテナンスブランチ)に適用されます。 トピックには、 ai/maint-topic という名前を付けることができます。
</p>
</li>
<li>
<p>
既存のトピックに関連する変更はブランチに適用されますが、以下のようになります:
</p>
<div class="ulist"><ul>
<li>
<p>
明らかに正しいものが最初に適用されます
</p>
</li>
<li>
<p>
疑わしいものは廃棄されるか、先端近くで適用されます
</p>
</li>
</ul></div>
</li>
<li>
<p>
既存のトピックへの置換パッチは、 <code>next</code> にないコミットに対してのみ受け入れられます。
</p>
<div class="paragraph"><p>最初のラウンドは以下のように行われます:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout ai/topic ;# or "git checkout -b ai/topic master"
$ git am -sc3 mailbox</code></pre>
</div></div>
<div class="paragraph"><p>既存のトピックを次のラウンドに置き換えるには、以下のようにします:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout master...ai/topic ;# try to reapply to the same base
$ git am -sc3 mailbox</code></pre>
</div></div>
<div class="paragraph"><p>切り離されたHEAD(detached HEAD)で新しいラウンドを準備し、それから以下のようにします</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git range-diff @{-1}...
$ git diff @{-1}</code></pre>
</div></div>
<div class="paragraph"><p>前回のラウンドから何が変わったかを再確認し、最後に以下のようにします</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout -B @{-1}</code></pre>
</div></div>
<div class="paragraph"><p>これで完結させます(最後のステップは、なぜ、すでに「next」にあるトピックが置き換えられず、段階的に更新されるかを示しています)。</p></div>
<div class="paragraph"><p>それが最初のラウンドであろうと後続ラウンドであろうと、トピックは単独でも構築されない可能性があり、または、バグが原因で統合ブランチにマージされたときにビルドが破損する可能性があります。メーリングリストには、すでに明白で些細な改善が提案されている可能性があります。 メンテナは、統合ブランチを公開して、他の開発者がテストに使用できるようにする前に、物事を修正するために、そのタイトルに「SQUASH???」を使用して余分のコミットを追加することがよくあります。 これらの変更は、メンテナが100％コミットしているわけではないため(些細なタイプミスなどは、個別の「SQUASH???」コミットとして適用されることなく、修正が必要なパッチに直接押しつぶされる(squash)ことがよくあります)、必要に応じて簡単に削除できます。</p></div>
</li>
</ul></div>
</li>
<li>
<p>
必要に応じて、maint を master にマージ:
</p>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout master
$ git merge maint
$ make test</code></pre>
</div></div>
</li>
<li>
<p>
必要に応じて master を next にマージ:
</p>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout next
$ git merge master
$ make test</code></pre>
</div></div>
</li>
<li>
<p>
「What&#8217;s cooking」の最後の号をもう一度レビューし、「next」にマージする準備ができているトピックがまだ良好な状態であるかどうかを確認します(たとえば、このシリーズのリストに新しい問題が提起されていませんか？)
</p>
</li>
<li>
<p>
<code>jch</code> ブランチを準備します。これは、 <code>master</code> と <code>seen</code> の間のどこかを表すために使用され、多くの場合、 <code>next</code> よりわずかに進んでいます。
</p>
<div class="literalblock">
<div class="content">
<pre><code>$ Meta/Reintegrate master..seen &gt;Meta/redo-jch.sh</code></pre>
</div></div>
<div class="paragraph"><p>結果は、Meta/Reintegrate スクリプトへの入力として「seen」を再構築するためにマージされるトピックをリストするスクリプトです。 まだ「jch」に含まれていてはならない後続のトピックを削除します。 出力の最初のトピックの名前の前に <code>### match next</code> という行を追加します。これは、「jch」に含まれている必要がありますが、「next」には含まれていません。</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ Meta/Reintegrate master..jch &gt;Meta/redo-jch.sh</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>The result is a script that lists topics to be merged in order to
rebuild 'seen' as the input to Meta/Reintegrate script.  Remove
later topics that should not be in 'jch' yet.  Add a line that
consists of '### match next' before the name of the first topic
in the output that should be in 'jch' but not in 'next' yet.</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
これで、トピックを「next」にマージする準備が整いました。 先端が「next」にマージされていないブランチごとに、以下の3つのいずれかが発生する可能性があります:
</p>
<div class="ulist"><ul>
<li>
<p>
コミットはすべてnextにマージする価値があります。 トピックをnextにマージします。
</p>
</li>
<li>
<p>
新しい部品は混合品質ですが、初期の部品はnextにマージする価値があります。 初期の部品をnextにマージします。
</p>
</li>
<li>
<p>
nextにマージする価値のあるものはありません。何もしません。
</p>
<div class="paragraph"><p>この手順は、以前に作成した Meta/redo-jch.sh スクリプトを使用して支援されます。 すでに「next」にあるトピックにパッチが適用された場合、スクリプトはそれを <code>ai/topic~1</code> としてリストします。 更新された「next」に新しいパッチを含めるには、 <code>~1</code> の部分を削除します。除外したいモノの行はそのままにしてください。 <code>next</code> になかったトピックを <code>next</code> にマージする必要がある場合は、リストの最後に追加します。 それから以下のようにします:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout -B jch master
$ Meta/redo-jch.sh -c1</code></pre>
</div></div>
<div class="paragraph"><p>これは <code>jch</code> ブランチを最初から再構築します。 <code>-c1</code> は、 <code>###</code> で始まる最初の行(つまり、以前に追加した <code>### match next</code> 行)でマージを停止するようにスクリプトに指示します。</p></div>
<div class="paragraph"><p>この時点で、結果をビルドテストします。 セマンティックの競合が明らかになる場合があります(たとえば、トピックが変数の名前を変更し、別のトピックが古い名前で変数への新しい参照を追加したとか)。その場合、最初に適切なマージ修正(merge-fix)を準備し(appendix参照)、そしてゼロからから「jch」ブランチを再構築し。 「master」の先端から始めます。</p></div>
<div class="paragraph"><p>それから同じ事を「next」に行います</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout next
$ sh Meta/redo-jch.sh -c1 -e</code></pre>
</div></div>
<div class="paragraph"><p><code>-e</code> オプションを使用すると、トピックの履歴からのマージメッセージと「What&#8217;s cooking」のコメントを編集できます。 同じトピックのセットが「master」にマージされるため、結果のツリーは「jch」と一致する必要があります。 そうでなければ、ミスマージがあります。 理由を調査し、ミスマージが検出されて修正されるまで続行しないでください。</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git diff jch next</code></pre>
</div></div>
<div class="paragraph"><p>全てOKになったら、 redo-jch.sh スクリプトで以下のようにクリーンアップします</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ sh Meta/redo-jch.sh -u</code></pre>
</div></div>
<div class="paragraph"><p>これにより、スクリプト内にリストされてる、「master」にすでにマージされているトピックを削除します。 これにより、「# match next」マーカーが失われる可能性があります。 もし「# match next」マーカーが失われたら、適切な場所に再度追加します。</p></div>
</li>
</ul></div>
</li>
<li>
<p>
コミットはすべてnextにマージする価値があります。 トピックをnextにマージします。
</p>
</li>
<li>
<p>
新しい部品は混合品質ですが、初期の部品はnextにマージする価値があります。 初期の部品をnextにマージします。
</p>
</li>
<li>
<p>
nextにマージする価値のあるものはありません。何もしません。
</p>
<div class="literalblock">
<div class="content">
<pre><code>This step is aided with Meta/redo-jch.sh script created earlier.
If a topic that was already in 'next' gained a patch, the script
would list it as "ai/topic~1".  To include the new patch to the
updated 'next', drop the "~1" part; to keep it excluded, do not
touch the line.  If a topic that was not in 'next' should be
merged to 'next', add it at the end of the list.  Then:</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout -B jch master
$ sh Meta/redo-jch.sh -c1</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>これは `jch` ブランチを最初から再構築します。 `-c1` は、 `###` で始まる最初の行(つまり、以前に追加した `### match next` 行)でマージを停止するようにスクリプトに指示します。</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>この時点で、結果をビルドテストします。 セマンティックの競合が明らかになる場合があります(たとえば、トピックが変数の名前を変更し、別のトピックが古い名前で変数への新しい参照を追加したとか)。その場合、最初に適切なマージ修正(merge-fix)を準備し(appendix参照)、そしてゼロからから「jch」ブランチを再構築し。 「master」の先端から始めます。</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>それから同じ事を「next」に行います</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout next
$ sh Meta/redo-jch.sh -c1 -e</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>`-e` オプションを使用すると、トピックの履歴からのマージメッセージと「What's cooking」のコメントを編集できます。 同じトピックのセットが「master」にマージされるため、結果のツリーは「jch」と一致する必要があります。 そうでなければ、ミスマージがあります。 理由を調査し、ミスマージが検出されて修正されるまで続行しないでください。</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git diff jch next</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>Then build the rest of 'jch':</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout jch
$ sh Meta/redo-jch.sh</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>全てOKになったら、 redo-jch.sh スクリプトで以下のようにクリーンアップします</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>$ sh Meta/redo-jch.sh -u</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>これにより、スクリプト内にリストされてる、「master」にすでにマージされているトピックを削除します。 これにより、「### match next」マーカーが失われる可能性があります。 もし「### match next」マーカーが失われたら、適切な場所に再度追加します。</code></pre>
</div></div>
</li>
<li>
<p>
「seen」を再構築します。
</p>
<div class="literalblock">
<div class="content">
<pre><code>$ Meta/Reintegrate jch..seen &gt;Meta/redo-seen.sh</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>スクリプトに、まだ「表示」(seen)されていない新しいトピックを追加して、結果を編集します。 それから以下のようにします</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout -B seen jch
$ sh Meta/redo-seen.sh</code></pre>
</div></div>
<div class="paragraph"><p>これが全てがOKになったら、redo-seen.sh スクリプトで以下のようにしてクリーンアップします</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ sh Meta/redo-seen.sh -u</code></pre>
</div></div>
<div class="paragraph"><p>実行して再確認(double check)します</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git branch --no-merged seen</code></pre>
</div></div>
<div class="paragraph"><p>予期しない残りのトピックがないことを確認します。</p></div>
<div class="paragraph"><p>この時点で、結果をビルドテストします。 セマンティックの競合が明らかになる場合があります(たとえば、トピックが変数の名前を変更し、別のトピックが古い名前で変数への新しい参照を追加したとか)。その場合、最初に適切なマージ修正(merge-fix)を準備し(appendix参照)、そしてゼロからから「seen」ブランチを再構築し。 「jch」の先端から始めます。</p></div>
</li>
</ul></div>
</li>
<li>
<p>
「What&#8217;s cooking」メッセージを更新して、既存のトピック、新しく追加されたトピック、および段階的なトピックの更新を確認します。
</p>
<div class="paragraph"><p>このステップは 「git am」で実行されます。</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ Meta/cook</code></pre>
</div></div>
<div class="paragraph"><p>このスクリプトは、 <code>master..seen</code> 間の履歴を検査し、トピックブランチの先端を見つけ、見つかったものを Meta/whats-cooking.txt の現在の内容と比較し、 Meta/whats-cooking.txt を更新します。 ファイルにリストされていないが <code>master..seen</code> にあるトピックは、「New topics」セクションに追加されます。ファイルにリストされ、 <code>master..seen</code> に見つからなくなったトピックは、「Graduated to master」セクションに移動されます。 コミットによって状態が変更されたトピック(たとえば、以前は「seen」のみでしたが、現在は「next」にマージされていますとか）は、変更マーカー <code>&lt;&lt;</code> および <code>&gt;&gt;</code> で更新されます。</p></div>
<div class="paragraph"><p><code>&lt;&lt;</code> と <code>&gt;&gt;</code> で囲まれた行を探します。 これらは、この統合ラウンドによって置き換えられた古いファイルのコンテンツを保持します。 それらを確認(verify)した後、古い部分を削除します。 各トピックの説明を確認し、必要に応じてその完成度と計画を更新します。 更新された計画を確認するには、以下を実行します</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ Meta/cook -w</code></pre>
</div></div>
<div class="paragraph"><p>これは、 "Will merge to <em>next</em>" などの、トピックに付けられたコメントを取得します(サポートされているフレーズの種類については、 Meta/cook を参照してください)。</p></div>
</li>
<li>
<p>
4つ(5つ)すべての統合ブランチをコンパイル、テスト、およびインストールします。 Meta/Dothem スクリプトは、このステップで役立つでしょう。
</p>
</li>
<li>
<p>
<code>master</code> ブランチが更新された場合は、ドキュメントをフォーマットします。 Meta/dodoc.sh スクリプトがこのステップに役立つでしょう。
</p>
</li>
<li>
<p>
統合ブランチを公共の場所にプッシュします。 Meta/pushall スクリプトがこのステップに役立つでしょう。
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_observations">Observations</h2>
<div class="sectionbody">
<div class="paragraph"><p>行うべきいくつかの観測。</p></div>
<div class="ulist"><ul>
<li>
<p>
各トピックは個別にテストされ、他のトピックと一緒に、最初に「seen」、次に「jch」、それから「next」で調理(cooking)されます。 それが成熟するまで、その一部は「master」にマージされません。
</p>
</li>
<li>
<p>
すでに「next」にあるトピックは、「next」にある間に修正を取得できます。 このようなトピックには、「next」への多くのマージがあります（つまり、 <code>git log --first-parent next</code> は、同じトピックに対して多くの「nextへマージする <code>ai/topic</code> ブランチ」(Merge branch <em>ai/topic</em> to next)を表示します。
</p>
</li>
<li>
<p>
<code>maint</code> の明白でない修正は、 <code>next</code> で調理され、 <code>master</code> にマージされて、それがOKであることを確認してから、 <code>maint</code> にマージされます。
</p>
</li>
<li>
<p>
<code>next</code> が空になった場合(つまり、すべてのトピックが安定して <code>master</code> にマージされ、 <code>git diff master next</code> が空の場合)でも、<code>next</code> には、 <code>master</code> には決して存在しない大量のマージコミットがあります。
</p>
</li>
<li>
<p>
原則として、 <code>git log --first-parent master..next</code> はマージのみを表示するべきです(実際には、マージではない fixupコミット と revert があります)。
</p>
</li>
<li>
<p>
<code>next</code> にないトピックブランチの先端近くのコミットは、破棄または置換または書き換えのいいカモ(fair game)です。 <code>next</code> にすでにマージされているコミットはそうではありません。
</p>
</li>
<li>
<p>
<code>next</code> ブランチにあることは、そのトピックが次の機能リリースに含まれることを保証するものではありません。「master」ブランチにあるのは通常、次の機能リリースに含まれます。
</p>
</li>
<li>
<p>
「SQUASH???」修正の性質上、元の作成者が提案された変更に同意する場合は、次のラウンドで適切なパッチにそれらを押しつぶして(squash)もかまいません(提案された変更が十分に小さい場合、作成者は「Helped-by」を気にする必要はありません)。元の作者が提案に同意しない場合は、次のラウンドからそれらを削除することもできますが、作者は議論のどこかで理由を述べることが期待されます。
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix">Appendix</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_preparing_a_merge_fix">Preparing a "merge-fix"</h3>
<div class="paragraph"><p>2つのトピックのマージは、字面的には競合しなくても、意味レベルでは競合が発生する場合があります。 古典的な例は、あるトピックで変数とそのすべての使用法の名前を変更し、別のトピックで変数の新しい使用法を古い名前で追加する場合です。 これらの2つのトピックがマージされた場合、後者のトピックによって新しく追加された変数への参照は、結果的に古い名前を引き続き使用します。</p></div>
<div class="paragraph"><p>redo-jch および redo-seen スクリプトで使用される Meta/Reintegrate スクリプトは、この問題を回避するための大雑把ですが使用可能な方法を実装しています。 スクリプトがブランチ$Xをマージするとき、「refs/merge-fix/$X」が存在するかどうかをチェックし、存在する場合、その効果は機械的マージの結果に押しつぶされ(squash)ます。 言い換えると、</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ echo $X | Meta/Reintegrate</code></pre>
</div></div>
<div class="paragraph"><p>これは以下のシーケンスとほぼ同等です:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git merge --rerere-autoupdate $X
$ git commit
$ git cherry-pick -n refs/merge-fix/$X
$ git commit --amend</code></pre>
</div></div>
<div class="paragraph"><p>この「prepare a merge-fix」(マージ修正の準備)ステップの目標は、セマンティックの競合を修正するために、機械的なマージの結果に押しつぶす(squash)ことができるコミットを提案することです。</p></div>
<div class="paragraph"><p>ブランチ「ai/topic」を統合ブランチにマージした結果に、たとえば <code>seen~4</code> のようなセマンティックの競合があることがわかった後、切り離されたHEAD(detached HEAD)で問題のあるマージをチェックし、作業ツリーを編集してセマンティックの競合を修正し、修正を記録するための別のコミットを行います:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout seen~4
$ git show -s --pretty=%s ;# double check
Merge branch 'ai/topic' to seen
$ edit
$ git commit -m 'merge-fix/ai/topic' -a</code></pre>
</div></div>
<div class="paragraph"><p>次に、「refs/merge-fix/ai/topic」を参照して、この結果を示します:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git update-ref refs/merge-fix/ai/topic HEAD</code></pre>
</div></div>
<div class="paragraph"><p>それから、Meta/Reintegrate にマージをやり直すように依頼して、結果を再確認(double check)します:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ git checkout seen~5 ;# the parent of the problem merge
$ echo ai/topic | Meta/Reintegrate
$ git diff seen~4</code></pre>
</div></div>
<div class="paragraph"><p>今回は、refs/merge-fix/ai/topic を準備したため、結果のマージは、セマンティックの競合の修正を含むように調整されているはずです。</p></div>
<div class="paragraph"><p>注意: これは、競合するブランチがマージされる順序が変更されないことを前提としていることに注意してください。 ai/topic ブランチをマージする理由がこのマージ修正を必要とする場合、統合ブランチに以前にマージされた別のブランチが、ai/topicブランチが作成した基本的な仮定を変更したためです(たとえば、ai/topicブランチは、変数を参照するサイトを追加しましたが、 他のブランチはその変数の名前を変更し、既存の使用サイトを調整したとか)、他のブランチの前に ai/topic ブランチをマージするように redo-jch(またはredo-seen)スクリプトを変更した場合、ai/topicのマージ中に上記のmerge-fixを適用しないで、代わりに他のブランチをマージするときに適用する必要があります。他のブランチに適用するには、修正を移動する必要があります。おそらく以下のようになります:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ mf=refs/merge-fix
$ git update-ref $mf/$the_other_branch $mf/ai/topic
$ git update-ref -d $mf/ai/topic</code></pre>
</div></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2023-07-27 05:08:15 JST
</div>
</div>
</body>
</html>
